---
title: 工作中遇到的问题总结
date: 2022-01-05 13:37:59
tags:
---

### 1. uniapp APP 端字体图标 不支持在 main.js import 导入引用 需在 iconfont.css 中

```
@font-face {font-family: "iconfont";
  src: url('./static/icon/iconfont.eot?t=1615533880049');
  src: url('./static/icon/iconfont.eot?t=1615533880049#iefix') format('embedded-opentype'),
 url('//at.alicdn.com/t/font_2339562_u3chnxn701.woff2') format('woff2'),
  url('./static/icon/iconfont.woff?t=1615533880049') format('woff'),
  url('./static/icon/iconfont.ttf?t=1615533880049') format('truetype'),
  url('./static/icon/iconfont.svg?t=1615533880049#iconfont') format('svg');
}
```

然后在 App.vue

```
<style>
@import "@/static/icon/iconfont.css";
</style>
```

### 2. element el-select 回显时 label 显示 value 数字

解决方案：获取字段不能为 number 格式 要转换为 string 调用.toString()方法

### 3. 小程序中不支持 webview 可跳转到其他小程序

### 4. 移动端 h5 图片下载

```
downloadIamge(src) {
			var imgsrc = src.replace('https://cdn.zouliang.net', '/cdnimg');
			var image = new Image();
			// 解决跨域 Canvas 污染问题
			image.setAttribute('crossOrigin', 'anonymous');
			image.onload = function() {
				var canvas = document.createElement('canvas');
				canvas.width = image.width;
				canvas.height = image.height;
				var context = canvas.getContext('2d');
				context.drawImage(image, 0, 0, image.width, image.height);
				var url = canvas.toDataURL('image/png'); //得到图片的base64编码数据
				var a = document.createElement('a'); // 生成一个a元素
				var event = new MouseEvent('click'); // 创建一个单击事件
				a.download = 'sucai'; // 设置图片名称
				a.href = url; // 将生成的URL设置为a.href属性
				a.dispatchEvent(event); // 触发a的单击事件
			};
			image.src = imgsrc;
		},
```

### 5. element el-dialog 中使用 el-select 选项框会随滚动条偏移

解决方案：
el-select 标签中增加:popper-append-to-body=”false”

```
<div class="elselect">
           <el-select
             :popper-append-to-body="false"
             v-model="portion"
             placeholder="请选择多份券数量"
           >
             <el-option label="3份" value="3" />
             <el-option label="5份" value="5" />
             <el-option label="10份" value="10" />
             <el-option label="20份" value="20" />
           </el-select>
         </div>
并添加css如下
	.elselect ::v-deep {
  		.el-select-dropdown.el-popper {
   			 position: absolute !important;
  	}
}
```

### 6. 小程序表单验证出错

解决方案：
需要验证的 form 表单 数据要初始化 不可以只为一个空对象

```
form: {
			mobile:'',
			captcha:'',
			password:'',
			repeat:''
		},
```

### 7. el-table el-table-column v-if条件渲染 可能会出现渲染混乱 报错

究其原因， 这是因为在v-for或者v-if切换标签时，多个相同的标签被渲染，如果不添加key来区分则会出现复用的情况。而原本这些标签每一个都是独立的，于是需要添加key来做区分！

表格是element-ui通过循环产生的，而vue在dom重新渲染时有一个性能优化机制，就是相同dom会被复用，这就是问题所在，所以，通过key去标识一下当前行是唯一的，不许复用，就行了。

解决方案：

el-table-column添加

```
 :key="Math.random()"
```
